webpackJsonp([8],{314:function(t,e,i){function s(t){i(546)}var n=i(1)(i(427),i(591),s,null,null);t.exports=n.exports},360:function(t,e,i){"use strict";function s(t){return(0,r.default)({url:"/inbox/list",method:"get",params:t})}function n(){return(0,r.default)({url:"/inbox/list",method:"get",params:{status:0,sort:"receiveDate",order:"descending"}})}function a(t){var e=String(t);return console.log("要删除的收件id:"+e),o.Observable.create(function(t){setTimeout(function(){t.next(!0)},1e3)})}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchList=s,e.fetchUnReadList=n,e.delReceiveMail=a;var l=i(38),r=function(t){return t&&t.__esModule?t:{default:t}}(l),o=i(64)},427:function(t,e,i){"use strict";function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var n=i(360),a=s(n),l=i(117),r=s(l),o=i(10);e.default={name:"inbox",data:function(){return{list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,title:void 0,status:void 0,sort:"",order:""},statusOptions:[{value:0,showValue:"未读"},{value:1,showValue:"已读"},{value:2,showValue:"已回复"},{value:3,showValue:"已转发"}],multipleSelection:[],tableKey:0,labelList:[]}},created:function(){this.initPage()},filters:{statusTypeFilter:function(t){return{0:"danger",1:"primary",2:"success",3:"gray"}[t]},statusShowFilter:function(t){return{0:"未读",1:"已读",2:"已回复",3:"已转发"}[t]}},methods:{initPage:function(){this.getList(),this.getLabelList()},getList:function(){var t=this;this.listLoading=!0,a.fetchList(this.listQuery).then(function(e){t.list=e.data.items,t.total=e.data.total,t.listLoading=!1})},getLabelList:function(){var t=this;r.fetchList().then(function(e){t.labelList=e.data.labelList})},handleFilter:function(){this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},customSort:function(t){this.listQuery.sort=t.prop,this.listQuery.order=t.order,this.getList()},timeFilter:function(t){if(!t[0])return this.listQuery.start=void 0,void(this.listQuery.end=void 0);this.listQuery.start=parseInt(+t[0]/1e3),this.listQuery.end=parseInt((+t[1]+864e5)/1e3)},goToDetail:function(t){this.$store.commit("SET_MAIL_ID",t),this.$store.commit("SET_MAIL_TYPE","receive"),this.$router.push({path:"/mail_detail/index"})},reply:function(t){if(1!==(this.multipleSelection.length||0))return void this.$message("请选择一封邮件进行回复");this.$store.commit("SET_MAIL_ID",this.multipleSelection[0].id),t?this.$store.commit("SET_PAGE_TYPE","replyAll"):this.$store.commit("SET_PAGE_TYPE","reply"),this.$store.commit("SET_MAIL_TYPE","receive"),this.$router.push({path:"/mail_send/index"})},forward:function(){if(1!==(this.multipleSelection.length||0))return void this.$message("请选择一封邮件进行转发");this.$store.commit("SET_MAIL_ID",this.multipleSelection[0].id),this.$store.commit("SET_PAGE_TYPE","forward"),this.$store.commit("SET_MAIL_TYPE","receive"),this.$router.push({path:"/mail_send/index"})},handleSelectionChange:function(t){this.multipleSelection=t},handleDelete:function(){var t=this,e=this.multipleSelection.length||0;if(e<1)return void this.$message("请选择邮件进行删除");this.$confirm("是否删除这"+e+"封邮件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];t.multipleSelection.forEach(function(t){return e.push(t.id)}),a.delReceiveMail(e).subscribe({next:function(){t.$message({message:"删除成功",type:"success",duration:2e3}),t.getList()},error:function(){return t.$message({showClose:!0,message:"删除失败",type:"error"})}})}).catch(function(){t.$message("操作已取消")})},handleDownload:function(){var t=this;i.e(19).then(function(){var e=i(347),s=e.export_json_to_excel,n=["发件人","发件邮箱","主题","接收时间","阅读时间"],a=["sendName","sendMail","title","receiveDate","readDate"];s(n,t.formatJson(a,t.list),(0,o.parseTime)(Date.now())+"收件箱数据")}.bind(null,i)).catch(i.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return~t.indexOf("Date")?(0,o.parseTime)(e[t]):e[t]})})},toggleStar:function(t){var e=this,i=[];if(t)i.push(t.id);else{if((this.multipleSelection.length||0)<1)return void this.$message("请选择邮件进行标记");this.multipleSelection.forEach(function(t){return i.push(t.id)})}r.toggleStar(i).subscribe({next:function(){t?t.isStar=!t.isStar:e.multipleSelection.forEach(function(t){return t.isStar=!0})}})},handleMark:function(t){var e=this;if("star"===t)this.toggleStar();else{if((this.multipleSelection.length||0)<1)return void this.$message("请选择邮件进行标记");var i=[];this.multipleSelection.forEach(function(t){return i.push(t.id)}),r.markLabel(t,i).subscribe({next:function(){return e.getList()}})}}}}},464:function(t,e,i){e=t.exports=i(307)(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"index.vue",sourceRoot:""}])},546:function(t,e,i){var s=i(464);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);i(308)("5600eafa",s,!0)},591:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-reply",attrs:{type:"primary"},on:{click:function(e){t.reply()}}},[i("icon-svg",{attrs:{"icon-class":"reply"}})],1),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-reply-all",attrs:{type:"primary"},on:{click:function(e){t.reply(!0)}}},[i("icon-svg",{attrs:{"icon-class":"reply-all"}})],1),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-forward",attrs:{type:"primary",icon:"share"},on:{click:t.forward}}),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-del",attrs:{type:"danger",icon:"delete"},on:{click:function(e){t.handleDelete()}}}),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"tool-item filter-item btn-reload",attrs:{type:"primary"},on:{click:t.initPage}},[i("icon-svg",{attrs:{"icon-class":"reload4"}})],1),t._v(" "),i("el-dropdown",{staticClass:"tool-item filter-item",attrs:{"split-button":"",type:"primary","menu-align":"start"},on:{command:t.handleMark}},[t._v("\n            标记为\n            "),i("el-dropdown-menu",{slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"star"}},[i("icon-svg",{staticClass:"download-icon",attrs:{"icon-class":"favourite"}}),t._v("星标邮件")],1),t._v(" "),t._l(t.labelList,function(e){return i("el-dropdown-item",{key:e.id,attrs:{command:e.id+""}},[i("icon-svg",{staticClass:"download-icon",attrs:{"icon-class":"label1"}}),t._v(t._s(e.name))],1)})],2)],1),t._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"300px"},attrs:{placeholder:"标题"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.handleFilter(e)}},model:{value:t.listQuery.title,callback:function(e){t.listQuery.title=e},expression:"listQuery.title"}}),t._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:"状态"},model:{value:t.listQuery.status,callback:function(e){t.listQuery.status=e},expression:"listQuery.status"}},t._l(t.statusOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.showValue,value:t.value}})})),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"text",icon:"document"},on:{click:t.handleDownload}},[t._v("导出")])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:t.tableKey,ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.list,border:"","highlight-current-row":""},on:{"sort-change":t.customSort,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection","min-width":"30px"}}),t._v(" "),i("el-table-column",{attrs:{align:"left",width:"90px",label:"信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("icon-svg",{staticClass:"star",attrs:{"icon-class":e.row.isStar?"favourite":"favourite-o"},nativeOn:{click:function(i){t.toggleStar(e.row)}}}),t._v(" "),e.row.isHaveFile?i("icon-svg",{staticClass:"file",attrs:{"icon-class":"label4"}}):t._e(),t._v(" "),e.row.isHaveAudio?i("icon-svg",{attrs:{"icon-class":"voice4"}}):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"status",sortable:"custom","class-name":"status-col",label:"状态",width:"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:t._f("statusTypeFilter")(e.row.status)}},[t._v(t._s(t._f("statusShowFilter")(e.row.status)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"sendName",sortable:"custom",align:"center",label:"发件人"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.sendMail,placement:"top"}},[i("span",[t._v(t._s(e.row.sendName))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"title",sortable:"custom",label:"主题","show-overflow-tooltip":!0,"min-width":"400px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link-type",on:{click:function(i){t.goToDetail(e.row.id)}}},[t._v(t._s(e.row.title))]),t._v(" "),t._l(e.row.labelList,function(e){return i("el-tag",{key:e.guid},[t._v(t._s(e.name))])})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"receiveDate",sortable:"custom",align:"center",label:"接收时间",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("parseTime")(e.row.receiveDate,"{y}-{m}-{d} {h}:{i}")))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"readDate",sortable:"custom",align:"center",label:"阅读时间",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(t._f("parseTime")(e.row.readDate,"{y}-{m}-{d} {h}:{i}")))])]}}])})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[i("el-pagination",{attrs:{"current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.listQuery.page=e}}})],1)],1)},staticRenderFns:[]}}});